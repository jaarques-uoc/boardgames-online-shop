(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){e.exports=a(47)},36:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(20),s=a.n(c);a(36),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(37);var o=a(2),l=a(15),i=a(1),u=a(8),d="id",m="email",h="type",E=function(e){return e&&e.id&&e.email&&e.type},p=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)})(function(e){var t=e.sessionCustomer;return n.a.createElement("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark"},n.a.createElement("a",{href:"/",className:"navbar-brand d-flex w-50 mr-auto"},"Boardgames online shop"),n.a.createElement("div",{className:"navbar-collapse collapse w-100",id:"collapsingNavbar3"},n.a.createElement("ul",{className:"nav navbar-nav ml-auto w-100 justify-content-end"},"ADMIN"===t.type&&n.a.createElement(n.a.Fragment,null,n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/users"},"Users")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/orders"},"All customer orders"))),E(t)&&n.a.createElement(n.a.Fragment,null,n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/users/".concat(t.id)},"Profile")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/cart"},"Cart")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/myOrders"},"My Orders")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/logout"},"Log out"))),!E(t)&&n.a.createElement("li",{className:"nav-item"},n.a.createElement(o.b,{className:"nav-link",to:"/login"},"Log in")))))}),f=a(3),g=a(4),b=a(6),v=a(5),S=a(7),y=function(e){return fetch(e,{method:"GET",headers:{Accept:"application/json"}}).then(O)},N=function(e,t){return fetch(e,{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(O)},O=function(e){if(e.ok)return e.json();throw console.log("Response not ok: ".concat(e.status)),""},w="https://api-gateway-ws.herokuapp.com",C={CUSTOMERS_WS:"".concat(w,"/customers-ws"),PRODUCTS_WS:"".concat(w,"/products-ws"),ORDERS_WS:"".concat(w,"/orders-ws"),CARTS_WS:"".concat(w,"/carts-ws")},j=function(){return y("".concat(C.CUSTOMERS_WS,"/customers/")).catch(function(e){throw console.log("Error when retrieving users: ".concat(e)),""})},A=function(e){return y("".concat(C.CUSTOMERS_WS,"/customers/").concat(e)).catch(function(t){throw console.log("Error when retrieving user ".concat(e,": ").concat(t)),""})},I=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={users:[]},a.loadUsers=function(){return j().then(function(e){return a.setState({users:e})})},a.loadUsers(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-12"},n.a.createElement("h1",null,"Users"),this.state.users&&this.state.users.length>0&&n.a.createElement("table",{className:"table"},n.a.createElement("thead",{className:"thead-light text-center"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"col"},"User id"),n.a.createElement("th",{scope:"col"},"Email address"),n.a.createElement("th",{scope:"col"},"Full name"),n.a.createElement("th",{scope:"col"},"Registration date"))),n.a.createElement("tbody",null,this.state.users.map(function(e,t){return n.a.createElement(x,{user:e,key:t})}))))))}}]),t}(n.a.Component),x=function(e){var t=e.user;return n.a.createElement("tr",{className:"text-center"},n.a.createElement("th",{scope:"row"},t.id),n.a.createElement("td",null,n.a.createElement(o.b,{to:"/users/".concat(t.id)},t.email)),n.a.createElement("td",null,t.fullName),n.a.createElement("td",null,t.date))},k=function(e){return"".concat(C.CARTS_WS,"/customers/").concat(e,"/cart")},R=function(e){return y(k(e)).catch(function(t){throw console.log("Error when retrieving cart for user ".concat(e,": ").concat(t)),""})},T=function(e,t){return N("".concat(k(e),"/item"),t).catch(function(t){throw console.log("Error when updating cart for user ".concat(e,": ").concat(t)),""})},U=function(e,t){return N("".concat(k(e),"/item/increment"),t).catch(function(t){throw console.log("Error when updating cart for user ".concat(e,": ").concat(t)),""})},P=a(30),D=function(e){var t=e.orderItem,a=e.onChange,r=e.disabled,c=e.readOnly,s=(t.productDto.price*t.quantity).toFixed(2);return n.a.createElement("tr",{className:"text-center cart-item"},n.a.createElement("td",null,n.a.createElement(o.b,{to:"/products/".concat(t.productDto.id)},n.a.createElement("img",{src:t.productDto.imageUrl}))),n.a.createElement("td",{className:"align-middle"},t.productDto.name),n.a.createElement("td",{className:"align-middle text-right"},t.productDto.price," \u20ac"),n.a.createElement("td",{className:"align-middle"},c?t.quantity:n.a.createElement(_,{quantity:t.quantity,onChange:a,disabled:r})),n.a.createElement("td",{className:"align-middle text-right"},s," \u20ac"))},_=function(e){var t=e.quantity,a=e.onChange,r=e.disabled;return n.a.createElement("select",{onChange:a,disabled:r,value:t},Object(P.a)(Array(11).keys()).map(function(e){return n.a.createElement("option",{value:e,key:e},e)}))},L=function(e){return e&&e.sort(function(e,t){return e.productDto.id.localeCompare(t.productDto.id)})},F=function(){return y("".concat(C.ORDERS_WS,"/orders/")).catch(function(e){throw console.log("Error when retrieving orders: ".concat(e)),""})},W=function(e){return y("".concat(C.ORDERS_WS,"/orders/").concat(e)).catch(function(t){throw console.log("Error when retrieving order ".concat(e,": ").concat(t)),""})},M=function(e,t){return N("".concat(C.ORDERS_WS,"/customers/").concat(t,"/orders/"),e).catch(function(e){throw console.log("Error when updating cart for user ".concat(t,": ").concat(e)),""})},q=function(e){var t=e.text,a=e.hideAlert,r=e.type;return n.a.createElement("div",{className:"alert alert-".concat(r," alert-dismissible"),role:"alert"},n.a.createElement("div",null,t),n.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:a},n.a.createElement("span",{"aria-hidden":"true"},"\xd7")))},Y=function(e){var t=e.text,a=e.hideAlert;return n.a.createElement(q,{text:t,hideAlert:a,type:"success"})},V=function(e){var t=e.text,a=e.hideAlert;return n.a.createElement(q,{text:t,hideAlert:a,type:"danger"})},B=function(){return{show:!1,count:0}},J=function(e){return{show:!0,count:e.count+1}},z=function(e){return Z(e,"success")},Q=function(e){return Z(e,"error")},Z=function(e,t){return K(e,t,J)},$=function(e){return H(e,"success")},G=function(e){return H(e,"error")},H=function(e,t){return K(e,t,B)},K=function(e,t,a){var r=Object(i.a)({},e);return r[t]=a(e[t]),r},X=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={cart:void 0,loading:!1,alerts:{createOrder:{success:B(),error:B()},updateItem:{success:B(),error:B()}},order:{}},a.onChange=function(e){return function(t){a.setState({loading:!0});var r={productDto:e,quantity:t.target.value};T(a.props.sessionCustomer.id,r).then(function(e){a.saveCartState(e),a.updateUpdateItemAlert(z)}).catch(function(){return a.updateUpdateItemAlert(Q)}).finally(function(){return a.setState({loading:!1})})}},a.calculateTotalPrice=function(e){return e.reduce(function(e,t){return e+t.quantity*t.productDto.price},0)},a.loadCart=function(){return R(a.props.sessionCustomer.id).then(a.saveCartState)},a.saveCartState=function(e){e.orderItemDtos=L(e.orderItemDtos),a.setState({cart:e})},a.createOrder=function(){a.setState({loading:!0}),M(a.state.cart,a.props.sessionCustomer.id).then(function(e){a.setState({cart:{},order:e}),a.updateCreateOrderAlert(z)}).catch(function(){return a.updateCreateOrderAlert(Q)}).finally(function(){return a.setState({loading:!1})})},a.isCartEmpty=function(){return!(a.state.cart&&a.state.cart.orderItemDtos)},a.updateCreateOrderAlert=function(e){return a.updateAlert("createOrder",e)},a.updateUpdateItemAlert=function(e){return a.updateAlert("updateItem",e)},a.updateAlert=function(e,t){var r=Object(i.a)({},a.state.alerts);r[e]=t(a.state.alerts[e]),a.setState({alerts:r})},a.loadCart(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.alerts,r=t.order;return n.a.createElement(n.a.Fragment,null,a.createOrder.success.show&&n.a.createElement(Y,{text:"(".concat(a.createOrder.success.count,") The order ").concat(r.id," has been created successfully!"),hideAlert:function(){return e.updateCreateOrderAlert($)}}),a.createOrder.error.show&&n.a.createElement(V,{text:"(".concat(a.createOrder.error.count,") The order has not been created due to an error."),hideAlert:function(){return e.updateCreateOrderAlert(G)}}),a.updateItem.success.show&&n.a.createElement(Y,{text:"(".concat(a.updateItem.success.count,") The cart has been updated successfully!"),hideAlert:function(){return e.updateUpdateItemAlert($)}}),a.updateItem.error.show&&n.a.createElement(V,{text:"(".concat(a.updateItem.error.count,") The cart has not been updated due to an error."),hideAlert:function(){return e.updateUpdateItemAlert(G)}}),n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-12"},n.a.createElement("div",{className:"d-flex"},n.a.createElement("div",{className:"p-2"},n.a.createElement("h1",null,"Cart")),n.a.createElement("div",{className:"ml-auto p-2"},n.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.createOrder,disabled:this.isCartEmpty()||this.state.loading},"Create order"))),!this.isCartEmpty()&&n.a.createElement("table",{className:"table"},n.a.createElement("thead",{className:"thead-light text-center"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"col"},"Product"),n.a.createElement("th",{scope:"col"},"Name"),n.a.createElement("th",{scope:"col"},"Price"),n.a.createElement("th",{scope:"col"},"Quantity"),n.a.createElement("th",{scope:"col"},"Total price"))),n.a.createElement("tbody",null,this.state.cart.orderItemDtos.map(function(t,a){return n.a.createElement(D,{orderItem:t,key:a,onChange:e.onChange(t.productDto),disabled:e.state.loading,readOnly:!1})}),n.a.createElement("tr",null,n.a.createElement("td",{colSpan:"5",className:"text-right"},this.calculateTotalPrice(this.state.cart.orderItemDtos).toFixed(2)," \u20ac"))))))))}}]),t}(n.a.Component),ee=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)})(X),te=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={user:void 0},a.loadUser=function(){return A(a.props.match.params.id).then(function(e){return a.setState({user:e})})},a.loadUser(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.state.user;return n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-12"},n.a.createElement("h1",null,"User ",this.props.match.params.id),e&&n.a.createElement("div",{className:"col-12"},n.a.createElement(ae,{label:"User id",value:e.id}),n.a.createElement(ae,{label:"Email address",value:e.email}),n.a.createElement(ae,{label:"Full name",value:e.fullName}),n.a.createElement(ae,{label:"Address",value:e.address}),n.a.createElement(ae,{label:"Country",value:e.country}),n.a.createElement(ae,{label:"Registration date",value:e.date})))))}}]),t}(n.a.Component),ae=function(e){var t=e.label,a=e.value;return n.a.createElement("div",{className:"form-group row"},n.a.createElement("label",{className:"col-sm-3 col-form-label"},t),n.a.createElement("label",{className:"col-sm-9 col-form-label"},a))},re=function(){return y("".concat(C.PRODUCTS_WS,"/products/")).catch(function(e){throw console.log("Error when retrieving productss: ".concat(e)),""})},ne=function(e){return y("".concat(C.PRODUCTS_WS,"/products/").concat(e)).catch(function(t){throw console.log("Error when retrieving product ".concat(e,": ").concat(t)),""})},ce=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={product:void 0,loading:!1,alerts:{success:B(),error:B()}},a.loadProduct=function(){return ne(a.props.match.params.id).then(function(e){return a.setState({product:e})})},a.addProduct=function(){a.setState({loading:!0}),U(a.props.sessionCustomer.id,a.state.product).then(a.showSuccessAlert).catch(a.showErrorAlert).finally(function(){return a.setState({loading:!1})})},a.showSuccessAlert=function(){return a.setState({alerts:z(a.state.alerts)})},a.showErrorAlert=function(){return a.setState({alerts:Q(a.state.alerts)})},a.hideSuccessAlert=function(){return a.setState({alerts:$(a.state.alerts)})},a.hideErrorAlert=function(){return a.setState({alerts:G(a.state.alerts)})},a.isLoggedIn=function(){return E(a.props.sessionCustomer)},a.loadProduct(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.state,t=e.product,a=e.alerts;return n.a.createElement(n.a.Fragment,null,a.success.show&&n.a.createElement(Y,{text:"(".concat(a.success.count,") The product has been added successfully!"),hideAlert:this.hideSuccessAlert}),a.error.show&&n.a.createElement(V,{text:"(".concat(a.error.count,") The product has not been added due to an error."),hideAlert:this.hideErrorAlert}),n.a.createElement("div",{className:"container content-padding"},t&&n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-4 text-center"},n.a.createElement("img",{src:t.imageUrl,alt:""})),n.a.createElement("div",{className:"col-4 d-flex align-items-start flex-column"},n.a.createElement("div",{className:"mb-auto p-2"},n.a.createElement("h1",{className:"product-info-padding"},t.name),n.a.createElement("h5",{className:"product-info-padding"},t.price," \u20ac"),n.a.createElement("div",null,t.description)),n.a.createElement("div",{className:"p-2"},n.a.createElement("button",{type:"button",className:"btn btn-primary",disabled:this.state.loading||!this.isLoggedIn(),onClick:this.addProduct},"Add to cart"))))))}}]),t}(n.a.Component),se=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)})(ce),oe=a(16),le=function(e){var t=e.fieldName,a=e.label,r=e.onChange,c=e.disabled;return n.a.createElement(ue,{fieldName:t,label:a,onChange:r,disabled:c,type:"text"})},ie=function(e){var t=e.fieldName,a=e.label,r=e.onChange,c=e.disabled;return n.a.createElement(ue,{fieldName:t,label:a,onChange:r,disabled:c,type:"password"})},ue=function(e){var t=e.fieldName,a=e.label,r=e.type,c=e.placeholder,s=e.onChange,o=e.disabled;return n.a.createElement("div",{className:"form-group row"},n.a.createElement("label",{htmlFor:t,className:"col-sm-3 col-form-label"},a),n.a.createElement("div",{className:"col-sm-9"},n.a.createElement("input",{type:r,className:"form-control",id:t,onChange:s,disabled:o,placeholder:c})))},de=function(e){return N("".concat(C.CUSTOMERS_WS,"/login/"),e).catch(function(t){throw console.log("Error when loging in user ".concat(e.email,": ").concat(t)),""})},me=function(e){return N("".concat(C.CUSTOMERS_WS,"/signup/"),e).catch(function(t){throw console.log("Error when registering user ".concat(e.email,": ").concat(t)),""})},he=function(e){return{type:"SAVE_SESSION_CUSTOMER",sessionCustomer:e}},Ee=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},pe=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(b.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(n)))).state={customer:{email:"",password:"",repeatPassword:"",fullName:"",address:"",country:""},alerts:{success:B(),error:B()}},a.signup=function(){return me(a.state.customer).then(function(e){a.props.saveSession(e),a.showSuccessAlert()}).catch(a.showErrorAlert)},a.onChange=function(e){return a.setState({customer:Object(i.a)({},a.state.customer,Object(oe.a)({},e.target.id,e.target.value))})},a.validateForm=function(){return!!a.state.customer.email&&!!a.state.customer.password&&a.state.customer.password===a.state.customer.repeatPassword&&!!a.state.customer.fullName&&!!a.state.customer.address&&!!a.state.customer.country&&Ee(a.state.customer.email)&&!a.isLoggedIn()},a.showSuccessAlert=function(){return a.setState({alerts:z(a.state.alerts)})},a.showErrorAlert=function(){return a.setState({alerts:Q(a.state.alerts)})},a.hideSuccessAlert=function(){return a.setState({alerts:$(a.state.alerts)})},a.hideErrorAlert=function(){return a.setState({alerts:G(a.state.alerts)})},a.isLoggedIn=function(){return E(a.props.sessionCustomer)},a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.state.alerts;return n.a.createElement(n.a.Fragment,null,!e.success.show&&this.isLoggedIn()&&n.a.createElement(Y,{text:"You have already been logged in successfully!",hideAlert:this.hideSuccessAlert}),e.success.show&&n.a.createElement(Y,{text:"(".concat(e.success.count,") The customer has been registered successfully!"),hideAlert:this.hideSuccessAlert}),e.error.show&&n.a.createElement(V,{text:"(".concat(e.error.count,") The customer has not been registered due to an error."),hideAlert:this.hideErrorAlert}),n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-8"},n.a.createElement("form",null,n.a.createElement(le,{fieldName:"email",label:"Email address",disabled:this.isLoggedIn(),onChange:this.onChange}),n.a.createElement(ie,{fieldName:"password",label:"Password",disabled:this.isLoggedIn(),onChange:this.onChange}),n.a.createElement(ie,{fieldName:"repeatPassword",label:"Repeat password",disabled:this.isLoggedIn(),onChange:this.onChange}),n.a.createElement(le,{fieldName:"fullName",label:"Full name",disabled:this.isLoggedIn(),onChange:this.onChange}),n.a.createElement(le,{fieldName:"address",label:"Address",disabled:this.isLoggedIn(),onChange:this.onChange}),n.a.createElement(le,{fieldName:"country",label:"Country",disabled:this.isLoggedIn(),onChange:this.onChange}),n.a.createElement("div",{className:"form-group row"},n.a.createElement("div",{className:"col-sm-10"},n.a.createElement("button",{type:"button",onClick:this.signup,disabled:!this.validateForm(),className:"btn btn-primary"},"Sign up"))))))))}}]),t}(n.a.Component),fe={saveSession:he},ge=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)},fe)(pe),be=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(b.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(n)))).state={customer:{email:"",password:""},alerts:{success:B(),error:B()}},a.login=function(){return de(a.state.customer).then(function(e){a.props.saveSession(e),a.showSuccessAlert()}).catch(a.showErrorAlert)},a.onChange=function(e){return a.setState({customer:Object(i.a)({},a.state.customer,Object(oe.a)({},e.target.id,e.target.value))})},a.validateForm=function(){return!!a.state.customer&&!!a.state.customer.email&&!!a.state.customer.password&&Ee(a.state.customer.email)&&!a.isLoggedIn()},a.showSuccessAlert=function(){return a.setState({alerts:z(a.state.alerts)})},a.showErrorAlert=function(){return a.setState({alerts:Q(a.state.alerts)})},a.hideSuccessAlert=function(){return a.setState({alerts:$(a.state.alerts)})},a.hideErrorAlert=function(){return a.setState({alerts:G(a.state.alerts)})},a.isLoggedIn=function(){return E(a.props.sessionCustomer)},a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.state.alerts;return n.a.createElement(n.a.Fragment,null,!e.success.show&&this.isLoggedIn()&&n.a.createElement(Y,{text:"You have already been logged in successfully!",hideAlert:this.hideSuccessAlert}),e.success.show&&n.a.createElement(Y,{text:"(".concat(e.success.count,") You have been logged in successfully!"),hideAlert:this.hideSuccessAlert}),e.error.show&&n.a.createElement(V,{text:"(".concat(e.error.count,") You have not been logged in due to an error."),hideAlert:this.hideErrorAlert}),n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-4"},n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"email"},"Email address"),n.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",disabled:this.isLoggedIn(),onChange:this.onChange,placeholder:"Enter email"})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",id:"password",disabled:this.isLoggedIn(),onChange:this.onChange,placeholder:"Password"})),n.a.createElement("button",{type:"button",disabled:!this.validateForm(),onClick:this.login,className:"btn btn-primary btn-block"},"Log in")))),n.a.createElement("div",{className:"row justify-content-center login-separator"},n.a.createElement("div",{className:"col-1"},n.a.createElement("hr",null)),n.a.createElement("div",{className:"col-auto"},"or"),n.a.createElement("div",{className:"col-1"},n.a.createElement("hr",null))),n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-4"},n.a.createElement(o.b,{to:"/signup"},n.a.createElement("button",{type:"button",className:"btn btn-primary btn-block",disabled:this.isLoggedIn()},"Sign up"))))))}}]),t}(n.a.Component),ve={saveSession:he},Se=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)},ve)(be),ye=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={order:void 0},a.loadOrder=function(){return W(a.props.match.params.id).then(function(e){e.orderItemDtos=L(e.orderItemDtos),a.setState({order:e})})},a.loadOrder(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-12"},n.a.createElement("h1",null,"Order ",this.props.match.params.id),this.state.order&&this.state.order.orderItemDtos&&n.a.createElement("table",{className:"table"},n.a.createElement("thead",{className:"thead-light text-center"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"col"},"Product"),n.a.createElement("th",{scope:"col"},"Name"),n.a.createElement("th",{scope:"col"},"Price"),n.a.createElement("th",{scope:"col"},"Quantity"),n.a.createElement("th",{scope:"col"},"Total price"))),n.a.createElement("tbody",null,this.state.order.orderItemDtos.map(function(e,t){return n.a.createElement(D,{orderItem:e,key:t,readOnly:!0})}),n.a.createElement("tr",null,n.a.createElement("td",{colSpan:"5",className:"text-right"},this.state.order.amount," \u20ac")))),n.a.createElement("h4",null,"Status"),this.state.orderEvents&&n.a.createElement("table",{className:"table"},n.a.createElement("thead",{className:"thead-light text-center"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"col"},"Status"),n.a.createElement("th",{scope:"col"},"Date"))),n.a.createElement("tbody",null,this.state.orderEvents.map(function(e,t){return n.a.createElement("tr",{className:"text-center cart-item",key:"events_".concat(t)},n.a.createElement("td",null,e.status),n.a.createElement("td",null,e.eventDate))}),n.a.createElement("tr",null,n.a.createElement("td",{colSpan:"5",className:"text-right"},this.state.order.amount," \u20ac")))))))}}]),t}(n.a.Component),Ne=function(e){var t=e.children,a=e.id;return n.a.createElement(o.b,{to:"/products/".concat(a)},t)},Oe=function(e){var t=e.product,a=e.addProduct,r=e.disabled;return n.a.createElement("div",{className:"col-6 col-md-2 text-center"},n.a.createElement("div",{className:"grid-item"},n.a.createElement("div",null,n.a.createElement(Ne,{id:t.id},n.a.createElement("img",{src:t.imageUrl,alt:""}))),n.a.createElement(Ne,{id:t.id},t.name),n.a.createElement("div",null,t.price," \u20ac"),n.a.createElement("button",{type:"button",className:"btn btn-primary",disabled:r,onClick:function(){return a(t)}},"Add to cart")))},we=function(e){var t=e.productsRow,a=e.addProduct,r=e.disabled;return n.a.createElement("div",{className:"row grid-row"},t.map(function(e,t){return n.a.createElement(Oe,{product:e,addProduct:a,disabled:r,key:t})}))},Ce=function(e,t){if(e){var a=[];return e.map(function(e,r){return function(e,a,r){var n=Math.floor(r/t);r%t===0&&(e[n]=[]),e[n].push(a)}(a,e,r)}),a}},je=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={products:[],loading:!1,alerts:{success:B(),error:B()}},a.loadProducts=function(){return re().then(function(e){return a.setState({products:e})})},a.addProduct=function(e){a.setState({loading:!0}),U(a.props.sessionCustomer.id,e).then(a.showSuccessAlert).catch(a.showErrorAlert).finally(function(){return a.setState({loading:!1})})},a.showSuccessAlert=function(){return a.setState({alerts:z(a.state.alerts)})},a.showErrorAlert=function(){return a.setState({alerts:Q(a.state.alerts)})},a.hideSuccessAlert=function(){return a.setState({alerts:$(a.state.alerts)})},a.hideErrorAlert=function(){return a.setState({alerts:G(a.state.alerts)})},a.isLoggedIn=function(){return E(a.props.sessionCustomer)},a.loadProducts(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=Ce(this.state.products,6),a=this.state.alerts;return this.state.products&&n.a.createElement(n.a.Fragment,null,a.success.show&&n.a.createElement(Y,{text:"(".concat(a.success.count,") The product has been added successfully!"),hideAlert:this.hideSuccessAlert}),a.error.show&&n.a.createElement(V,{text:"(".concat(a.error.count,") The product has not been added due to an error."),hideAlert:this.hideErrorAlert}),n.a.createElement("div",{className:"container-fluid content-padding"},t.map(function(t,a){return n.a.createElement(we,{productsRow:t,addProduct:e.addProduct,disabled:e.state.loading||!e.isLoggedIn(),key:a})})))}}]),t}(n.a.Component),Ae=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)})(je),Ie=function(){return y("".concat(w,"/system/health")).catch(function(e){return console.log("Error when retrieving system health: ".concat(e))})},xe=function(){return n.a.createElement("h1",null,"System is currently loading. Wait for a couple of minutes and try again. Thanks!")},ke=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={systemStatus:void 0,initialTimeoutPassed:!1},a.loadSystemStatus=function(){return Ie().then(function(e){return a.setState({systemStatus:e})})},a.isSystemUp=function(){return a.state.systemStatus&&a.state.systemStatus.services.map(function(e){return e.status}).reduce(function(e,t){return"UP"===t&&e},!0)},a.loadSystemStatus(),setTimeout(function(){return a.setState({initialTimeoutPassed:!0})},2e3),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,this.isSystemUp()&&n.a.createElement(Ae,null),!this.isSystemUp()&&this.state.initialTimeoutPassed&&n.a.createElement(xe,null))}}]),t}(n.a.Component),Re=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).state={orders:[]},a.loadOrders=function(){return a.props.fetchOrders().then(function(e){return a.setState({orders:e})})},a.loadOrders(),a}return Object(S.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.state.orders;return n.a.createElement("div",{className:"container content-padding"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col-12"},n.a.createElement("h1",null,this.props.title),e&&e.length>0&&n.a.createElement("table",{className:"table"},n.a.createElement("thead",{className:"thead-light text-center"},n.a.createElement("tr",null,n.a.createElement("th",{scope:"col"},"Order id"),n.a.createElement("th",{scope:"col"},"User id"),n.a.createElement("th",{scope:"col"},"Total price"),n.a.createElement("th",{scope:"col"},"Checkout date"))),n.a.createElement("tbody",null,e.map(function(e,t){return n.a.createElement(Te,{order:e,key:t})}))))))}}]),t}(n.a.Component),Te=function(e){var t=e.order;return n.a.createElement("tr",{className:"text-center"},n.a.createElement("td",null,n.a.createElement(o.b,{to:"/orders/".concat(t.id)},t.id)),n.a.createElement("td",null,n.a.createElement(o.b,{to:"/users/".concat(t.customerId)},t.customerId)),n.a.createElement("td",{className:"text-right"},t.amount," \u20ac"),n.a.createElement("td",null,t.date))},Ue=Object(u.b)(function(e){return Object(i.a)({},e.sessionReducer)})(function(e){var t=e.sessionCustomer;return n.a.createElement(Re,{fetchOrders:function(){return e=t.id,y("".concat(C.ORDERS_WS,"/customers/").concat(e,"/orders/")).catch(function(t){throw console.log("Error when retrieving orders for customer ".concat(e,": ").concat(t)),""});var e},title:"My orders"})}),Pe=a(14),De=a(29),_e={sessionCustomer:{id:localStorage.getItem(d),email:localStorage.getItem(m),type:localStorage.getItem(h)}},Le=Object(Pe.c)({sessionReducer:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SAVE_SESSION_CUSTOMER":return(e=a.sessionCustomer).id&&localStorage.setItem(d,e.id),e.email&&localStorage.setItem(m,e.email),e.type&&localStorage.setItem(h,e.type),Object(i.a)({},t,{sessionCustomer:a.sessionCustomer});case"REMOVE_SESSION_CUSTOMER":return localStorage.removeItem(d),localStorage.removeItem(m),localStorage.removeItem(h),Object(i.a)({},t,{sessionCustomer:{}});default:return t}}}),Fe={removeSession:function(){return{type:"REMOVE_SESSION_CUSTOMER"}}},We=Object(u.b)(void 0,Fe)(function(e){return(0,e.removeSession)(),n.a.createElement(Y,{text:"You have successfully logged out!"})}),Me=n.a.createElement(o.a,null,n.a.createElement(p,null),n.a.createElement(l.c,null,n.a.createElement(l.a,{path:"/login",component:Se}),n.a.createElement(l.a,{path:"/logout",component:We}),n.a.createElement(l.a,{path:"/signup",component:ge}),n.a.createElement(l.a,{path:"/cart",component:ee}),n.a.createElement(l.a,{path:"/orders/:id",component:ye}),n.a.createElement(l.a,{path:"/orders",component:function(){return n.a.createElement(Re,{fetchOrders:F,title:"All customer orders"})}}),n.a.createElement(l.a,{path:"/myOrders",component:Ue}),n.a.createElement(l.a,{path:"/users/:id",component:te}),n.a.createElement(l.a,{path:"/users",component:I}),n.a.createElement(l.a,{path:"/products/:id",component:se}),n.a.createElement(l.a,{exact:!0,path:"/",component:ke}),n.a.createElement(l.a,{component:function(){return n.a.createElement("h1",{className:"container content-padding"},"Not found")}})));s.a.render(n.a.createElement(u.a,{store:Object(Pe.d)(Le,Object(Pe.a)(De.a))},Me),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[31,1,2]]]);
//# sourceMappingURL=main.a5aeecff.chunk.js.map